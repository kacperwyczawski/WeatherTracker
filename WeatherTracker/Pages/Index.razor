@page "/"
@using WeatherTracker.Services
@using WeatherTracker.Models
@inject ICityService CityService

<PageTitle>Weather Tracker | Home</PageTitle>

<MudContainer MaxWidth="MaxWidth.Medium">
    @foreach (var city in _cities)
    {
        <CityCard IconId="@city.LatestWeatherData?.IconId" CityName="@city.Name" CityId="@city.Id"
                  Temperature="@city.LatestWeatherData?.Temperature" Humidity="@city.LatestWeatherData?.Humidity"/>
    }
    <MudPaper Class="d-flex my-8 pa-4 justify-center">
        <MudIconButton Icon="@Icons.Filled.Add" Size="Size.Large" Href="/AddCity"/>
    </MudPaper>
</MudContainer>

@code
{
    IEnumerable<City> _cities;

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
        _cities = await CityService.GetAllCitiesAsync();
    }
}